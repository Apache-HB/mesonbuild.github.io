fragment_downloaded_cb({"url":"Creating-OSX-packages.html#page-description","fragment":"Meson does not have native support for building OSX packages but it\ndoes provide all the tools you need to create one yourself. The reason\nfor this is that it is a very hard task to write a system that\nprovides for all the different ways to do that but it is very easy to\nwrite simple scripts for each application.\nSample code for this can be found in the Meson manual test\nsuite.\nOSX app bundles are actually extremely simple. They are just a\ndirectory of files in a certain format. All the details you need to\nknow are on this\npage\nand it is highly recommended that you read it first.\nLet's assume that we are creating our app bundle into\n/tmp/myapp.app. Suppose we have one executable, so we need to\ninstall that into Contents/MacOS. If we define the executable like\nthis:\nthen we just need to initialize our build tree with this command:\nNow when we do ninja install the bundle is properly staged. If you\nhave any resource files or data, you need to install them into\nContents/Resources either by custom install commands or specifying\nmore install paths to the Meson command.\nNext we need to install an Info.plist file and an icon. For those we\nneed the following two Meson definitions.\nThe format of Info.plist can be found in the link or the sample\nproject linked above. The simplest way to get an icon in the icns\nformat is to save your image as a tiff an then use the tiff2icns helper\napplication that comes with XCode.\nSome applications assume that the working directory of the app process\nis the same where the binary executable is. If this is the case for\nyou, then you need to create a wrapper script that looks like this:\ninstall it with this:\nand make sure that you specify myapp.sh as the executable to run in\nyour Info.plist.\nIf you are not using any external libraries, this is all you need to\ndo. You now have a full app bundle in /tmp/myapp.app that you can\nuse. Most applications use third party frameworks and libraries,\nthough, so you need to add them to the bundle so it will work on other\npeoples' machines.\nAs an example we are going to use the SDL2\nframework. In order to bundle it in our app, we first specify an\ninstaller script to run.\nThe install script does two things. First it copies the whole\nframework into our bundle.\nThen it needs to alter the library search path of our\nexecutable(s). This tells OSX that the libraries your app needs are\ninside your bundle. In the case of SDL2, the invocation goes like\nthis:\nThis is the part of OSX app bundling that you must always do\nmanually. OSX dependencies come in many shapes and forms and\nunfortunately there is no reliable automatic way to determine how each\ndependency should be handled. Frameworks go to the Frameworks\ndirectory while plain .dylib files usually go to\nContents/Resources/lib (but you can put them wherever you like). To\nget this done you have to check what your program links against with\notool -L /path/to/binary and manually add the copy and fix steps to\nyour install script. Do not copy system libraries inside your bundle,\nthough.\nAfter this you have a fully working, self-contained OSX app bundle\nready for distribution.\nA .dmg installer is similarly quite simple, at its core it is\nbasically a fancy compressed archive. A good description can be found\non this page. Please read it\nand create a template image file according to its instructions.\nThe actual process of creating the installer is very simple: you mount\nthe template image, copy your app bundle in it, unmount it and convert\nthe image into a compressed archive. The actual commands to do this\nare not particularly interesting, feel free to steal them from either\nthe linked page above or from the sample script in Meson's test suite.\nThere are many ways to put the .dmg installer together and different\npeople will do it in different ways. The linked sample code does it by\nhaving two different scripts. This separates the different pieces\ngenerating the installer into logical pieces.\ninstall_script.sh only deals with embedding dependencies and fixing\nthe library paths.\nbuild_osx_installer.sh sets up the build with the proper paths,\ncompiles, installs and generates the .dmg package.\nThe main reasoning here is that in order to build a complete OSX\ninstaller package from source, all you need to do is to cd into the\nsource tree and run ./build_osx_installer.sh. To build packages on\nother platforms you would write scripts such as\nbuild_windows_installer.bat and so on.\n"});